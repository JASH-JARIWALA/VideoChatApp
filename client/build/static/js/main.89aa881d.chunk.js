(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{115:function(e,t){},131:function(e,t){},133:function(e,t){},147:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(11),l=a.n(c),o=(a(84),a(7)),i=a(68),u=(a(85),a(69)),s=a.n(u),m=a(40),d=a.n(m),f=a(74),g=(a(157),a(159)),v=a(158),E=a(160),b=a(156),p=a(78),j=a(24),y=a(152),O=a(153),h=a(154),k=a(155);function C(){var e=Object(i.a)(["\n  display: flex;\n  width: 100%;\n"]);return C=function(){return e},e}var S=new Audio("./skype_remix_2.mp3");S.loop=!0;var w=f.a.div(C());var T=function(){var e=Object(n.useRef)(null),t=Object(n.useState)(""),a=Object(o.a)(t,2),c=a[0],l=a[1],i=Object(n.useState)({}),u=Object(o.a)(i,2),m=u[0],f=u[1],C=Object(n.useState)(),T=Object(o.a)(C,2),N=T[0],D=T[1],x=Object(n.useState)(!1),z=Object(o.a)(x,2),A=z[0],L=z[1],P=Object(n.useState)(""),R=Object(o.a)(P,2),I=R[0],U=R[1],M=Object(n.useState)(),V=Object(o.a)(M,2),B=V[0],F=V[1],W=Object(n.useState)(!1),J=Object(o.a)(W,2),_=J[0],G=J[1],H=Object(n.useState)(!1),Y=Object(o.a)(H,2),$=Y[0],q=Y[1],K=Object(n.useState)(""),Q=Object(o.a)(K,2),X=Q[0],Z=Q[1],ee=Object(n.useRef)(),te=Object(n.useRef)(),ae=Object(n.useRef)(),ne=Object(n.useState)(!0),re=Object(o.a)(ne,2),ce=re[0],le=re[1],oe=Object(n.useState)(!0),ie=Object(o.a)(oe,2),ue=ie[0],se=ie[1];Object(n.useEffect)((function(){ae.current=s.a.connect(""),navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(e){D(e),ee.current&&(ee.current.srcObject=e)})).catch((function(e){j.b.error("Provide Permission")})),ae.current.on("yourID",(function(e){l(e)})),ae.current.on("allUsers",(function(e){console.log(e),f(e)})),ae.current.on("receiveCall",(function(e){console.log("Reciving"),L(!0),U(e.from.name),Z(e.from.id),F(e.signal)})),ae.current.on("changeNameStatus",(function(e){e.status||j.b.error("name already taken!")}))}),[]);var me,de,fe,ge,ve,Ee,be=r.a.createElement(v.a,{onSubmit:function(e){e.preventDefault();var t=e.target.name.value,a=!1;Object.keys(m).forEach((function(e){e!==c&&t===m[e]&&(a=!0)})),a?j.b.error("name already taken!"):ae.current.emit("changeName",{name:t})}},r.a.createElement(w,null,r.a.createElement(v.a.Group,{controlId:"name"},r.a.createElement(v.a.Label,null,"Change Display name"),r.a.createElement(v.a.Control,{type:"text",placeholder:"Enter name"}))),r.a.createElement(g.a,{variant:"primary",type:"submit"},"Change Name"));N&&(me=r.a.createElement("video",{className:"userVideo",playsInline:!0,muted:!0,ref:ee,autoPlay:!0}),"professor"===m[c]&&(de=Object.keys(m).map((function(t){return t===c?null:r.a.createElement(g.a,{variant:"primary",onClick:function(){return a=t,e.current=new d.a({initiator:!0,trickle:!1,stream:N}),console.log("Call user"),e.current.on("signal",(function(e){ae.current.emit("callUser",{userToCall:a,signalData:e,from:c})})),e.current.on("stream",(function(e){te.current&&(te.current.srcObject=e)})),ae.current.on("callAccepted",(function(t){G(!0),Z(a),e.current.signal(t),q(!0),console.log("accepted")})),e.current.on("error",(function(e){console.log(e),"Call ended"!==e&&alert("Connection error or client closed webpage!"),Z(""),G(!1),q(!1),ae.current.removeListener("callAccepted"),ae.current.removeListener("videoStatusChange"),ae.current.removeListener("audioStatusChange")})),ae.current.on("callEnded",(function(){e.current.destroy("Call ended")})),void ae.current.on("error",(function(t){e.current.destroy(t.message)}));var a},disabled:$,style:{margin:5}},"Call ",m[t])})))),_&&(fe=r.a.createElement("video",{className:"partnerVideo",playsInline:!0,ref:te,autoPlay:!0}),ve=r.a.createElement("h4",null,"Partner: ",m[X]),ge=r.a.createElement(g.a,{variant:"danger",onClick:function(){ae.current.emit("endCall",{id:X})}},"End Call"));var pe,je,ye=ce?"success":"danger",Oe=ue?"success":"danger",he=ce?r.a.createElement(y.a,{size:50}):r.a.createElement(O.a,{size:50}),ke=ue?r.a.createElement(h.a,{size:50}):r.a.createElement(k.a,{size:50});return Ee=r.a.createElement(r.a.Fragment,null,r.a.createElement(g.a,{variant:ye,onClick:function(){var t=N.getVideoTracks()[0];"ended"===t.readyState?navigator.mediaDevices.getUserMedia({video:!0}).then((function(a){var n=a.getVideoTracks()[0];N.removeTrack(t),N.addTrack(n),le(!0),_&&e.current.replaceTrack(t,n,N)})):"live"===t.readyState&&(t.stop(),le(!1),_&&e.current.replaceTrack(t,t,N))},style:{margin:5}}," ",he," "),r.a.createElement(g.a,{variant:Oe,onClick:function(){var t=N.getAudioTracks()[0];"ended"===t.readyState?navigator.mediaDevices.getUserMedia({audio:!0}).then((function(a){var n=a.getAudioTracks()[0];N.removeTrack(t),N.addTrack(n),se(!0),_&&e.current.replaceTrack(t,n,N)})):"live"===t.readyState&&(t.stop(),se(!1),_&&e.current.replaceTrack(t,t,N))},style:{margin:5}}," ",ke," ")),"professor"!==m[c]&&Object.keys(m).forEach((function(e){e!==c&&"professor"===m[e]&&(pe="Professor online")})),A&&m[X]?(S.play(),je=r.a.createElement("div",{className:"incommingCall"},r.a.createElement(E.a,{className:"text-center",style:{background:"black",color:"white"}},r.a.createElement(E.a.Header,null,r.a.createElement("h2",null,I," is calling you")),r.a.createElement(E.a.Body,null,r.a.createElement(E.a.Title,null),r.a.createElement(b.a,null,r.a.createElement(w,null,r.a.createElement(p.a,null,r.a.createElement(g.a,{size:"lg",variant:"danger",onClick:function(){}},"Reject")),r.a.createElement(p.a,null,r.a.createElement(g.a,{size:"lg",variant:"success",onClick:function(){S.pause(),S.currentTime=0,G(!0),L(!1),q(!0),e.current=new d.a({initiator:!1,trickle:!1,stream:N}),e.current.on("signal",(function(e){ae.current.emit("acceptCall",{signal:e,to:X})})),e.current.on("stream",(function(e){te.current.srcObject=e})),e.current.signal(B),e.current.on("error",(function(e){console.log(e),"Call ended"!==e&&alert("Connection error or client closed webpage!"),G(!1),U(""),Z(""),F(),q(!1),ae.current.removeListener("videoStatusChange"),ae.current.removeListener("audioStatusChange")})),ae.current.on("callEnded",(function(){e.current.destroy("Call ended")}))}},"Accept"))))),r.a.createElement(E.a.Footer,{className:"text-muted"})))):(S.pause(),S.currentTime=0),r.a.createElement(r.a.Fragment,null,je,r.a.createElement(b.a,{style:{color:"white"},fluid:!0},r.a.createElement(w,null,de),r.a.createElement(w,null,ge),r.a.createElement(w,null,r.a.createElement(p.a,null,me,r.a.createElement(w,null,Ee),r.a.createElement("h4",null,"You: ",m[c]),be,r.a.createElement(w,{style:{color:"green",fontWeight:"bold"}},pe)),r.a.createElement(p.a,null,fe,ve)),r.a.createElement(j.a,{autoClose:2e3})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(145),a(146);l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(T,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},79:function(e,t,a){e.exports=a(147)},84:function(e,t,a){},85:function(e,t,a){}},[[79,1,2]]]);
//# sourceMappingURL=main.89aa881d.chunk.js.map
(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{100:function(e,t){},116:function(e,t){},118:function(e,t){},132:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(11),l=a.n(c),o=(a(69),a(6)),i=a(56),u=(a(70),a(57)),s=a.n(u),m=a(28),d=a.n(m),f=a(58),g=a(142),v=a(144),E=a(143),b=a(141),p=a(63),j=a(17),y=a(137),O=a(138),k=a(139),h=a(140);function C(){var e=Object(i.a)(["\n  display: flex;\n  width: 100%;\n"]);return C=function(){return e},e}var S=new Audio("./skype_remix_2.mp3");S.loop=!0;var w=f.a.div(C());var T=function(){var e=Object(n.useRef)(null),t=Object(n.useState)(""),a=Object(o.a)(t,2),c=a[0],l=a[1],i=Object(n.useState)({}),u=Object(o.a)(i,2),m=u[0],f=u[1],C=Object(n.useState)(),T=Object(o.a)(C,2),N=T[0],z=T[1],D=Object(n.useState)(!1),x=Object(o.a)(D,2),A=x[0],L=x[1],R=Object(n.useState)(""),I=Object(o.a)(R,2),P=I[0],U=I[1],B=Object(n.useState)(),M=Object(o.a)(B,2),V=M[0],W=M[1],F=Object(n.useState)(!1),J=Object(o.a)(F,2),_=J[0],G=J[1],H=Object(n.useState)(!1),Y=Object(o.a)(H,2),$=Y[0],q=Y[1],K=Object(n.useState)(""),Q=Object(o.a)(K,2),X=Q[0],Z=Q[1],ee=Object(n.useRef)(),te=Object(n.useRef)(),ae=Object(n.useRef)(),ne=Object(n.useState)(!0),re=Object(o.a)(ne,2),ce=re[0],le=re[1],oe=Object(n.useState)(!0),ie=Object(o.a)(oe,2),ue=ie[0],se=ie[1];Object(n.useEffect)((function(){ae.current=s.a.connect(""),navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(e){z(e),ee.current&&(ee.current.srcObject=e)})).catch((function(e){j.b.error("Provide Permission")})),ae.current.on("yourID",(function(e){l(e)})),ae.current.on("allUsers",(function(e){console.log(e),f(e)})),ae.current.on("receiveCall",(function(e){console.log("Reciving"),L(!0),U(e.from.name),Z(e.from.id),W(e.signal)})),ae.current.on("changeNameStatus",(function(e){e.status||j.b.error("name already taken!")}))}),[]);var me,de,fe,ge,ve,Ee=r.a.createElement(g.a,{onSubmit:function(e){e.preventDefault();var t=e.target.name.value,a=!1;Object.keys(m).forEach((function(e){e!==c&&t===m[e]&&(a=!0)})),a?j.b.error("name already taken!"):ae.current.emit("changeName",{name:t})}},r.a.createElement(g.a.Group,{controlId:"name"},r.a.createElement(g.a.Label,null,"Change Display name"),r.a.createElement(g.a.Control,{type:"text",placeholder:"Enter name"})),r.a.createElement(v.a,{variant:"primary",type:"submit",size:"sm"},r.a.createElement("small",null,"Change Name")));N&&(me=r.a.createElement("video",{className:"userVideo",playsInline:!0,muted:!0,ref:ee,autoPlay:!0}),"professor"===m[c]&&(de=Object.keys(m).map((function(t){return t===c?null:r.a.createElement(v.a,{variant:"primary",onClick:function(){return a=t,e.current=new d.a({initiator:!0,trickle:!1,stream:N}),console.log("Call user"),e.current.on("signal",(function(e){ae.current.emit("callUser",{userToCall:a,signalData:e,from:c})})),e.current.on("stream",(function(e){te.current&&(te.current.srcObject=e)})),ae.current.on("callAccepted",(function(t){G(!0),Z(a),e.current.signal(t),q(!0),console.log("accepted")})),e.current.on("error",(function(e){console.log(e),"Call ended"!==e&&alert("Connection error or client closed webpage!"),Z(""),G(!1),q(!1),ae.current.removeListener("callAccepted"),ae.current.removeListener("videoStatusChange"),ae.current.removeListener("audioStatusChange")})),ae.current.on("callEnded",(function(){e.current.destroy("Call ended")})),void ae.current.on("error",(function(t){e.current.destroy(t.message)}));var a},disabled:$,style:{margin:5}},"Call ",m[t])})))),_&&(fe=r.a.createElement("video",{className:"partnerVideo",playsInline:!0,ref:te,autoPlay:!0}),ge=r.a.createElement("div",{className:"endCallButton"},r.a.createElement(v.a,{variant:"danger",onClick:function(){ae.current.emit("endCall",{id:X})}},"End Call")));var be,pe,je=ce?"success":"danger",ye=ue?"success":"danger",Oe=ce?r.a.createElement(y.a,{size:20}):r.a.createElement(O.a,{size:20}),ke=ue?r.a.createElement(k.a,{size:20}):r.a.createElement(h.a,{size:20});return ve=r.a.createElement(w,{className:"justify-content-md-center"},r.a.createElement(v.a,{variant:je,onClick:function(){var t=N.getVideoTracks()[0];"ended"===t.readyState?navigator.mediaDevices.getUserMedia({video:!0}).then((function(a){var n=a.getVideoTracks()[0];N.removeTrack(t),N.addTrack(n),le(!0),_&&e.current.replaceTrack(t,n,N)})):"live"===t.readyState&&(t.stop(),le(!1),_&&e.current.replaceTrack(t,t,N))},style:{margin:5}}," ",Oe," "),r.a.createElement(v.a,{variant:ye,onClick:function(){var t=N.getAudioTracks()[0];"ended"===t.readyState?navigator.mediaDevices.getUserMedia({audio:!0}).then((function(a){var n=a.getAudioTracks()[0];N.removeTrack(t),N.addTrack(n),se(!0),_&&e.current.replaceTrack(t,n,N)})):"live"===t.readyState&&(t.stop(),se(!1),_&&e.current.replaceTrack(t,t,N))},style:{margin:5}}," ",ke," ")),"professor"!==m[c]&&Object.keys(m).forEach((function(e){e!==c&&"professor"===m[e]&&(be="Professor online")})),A&&m[X]?(S.play(),pe=r.a.createElement("div",{className:"incommingCall"},r.a.createElement(E.a,{className:"text-center",style:{background:"black",color:"white"}},r.a.createElement(E.a.Header,null,r.a.createElement("h2",null,P," is calling you")),r.a.createElement(E.a.Body,null,r.a.createElement(E.a.Title,null),r.a.createElement(b.a,null,r.a.createElement(w,null,r.a.createElement(p.a,null,r.a.createElement(v.a,{size:"lg",variant:"danger",onClick:function(){}},"Reject")),r.a.createElement(p.a,null,r.a.createElement(v.a,{size:"lg",variant:"success",onClick:function(){S.pause(),S.currentTime=0,G(!0),L(!1),q(!0),e.current=new d.a({initiator:!1,trickle:!1,stream:N}),e.current.on("signal",(function(e){ae.current.emit("acceptCall",{signal:e,to:X})})),e.current.on("stream",(function(e){te.current.srcObject=e})),e.current.signal(V),e.current.on("error",(function(e){console.log(e),"Call ended"!==e&&alert("Connection error or client closed webpage!"),G(!1),U(""),Z(""),W(),q(!1),ae.current.removeListener("videoStatusChange"),ae.current.removeListener("audioStatusChange")})),ae.current.on("callEnded",(function(){e.current.destroy("Call ended")}))}},"Accept"))))),r.a.createElement(E.a.Footer,{className:"text-muted"})))):(S.pause(),S.currentTime=0),r.a.createElement(r.a.Fragment,null,pe,fe,r.a.createElement("div",{className:"userElements"},me,ve),ge,r.a.createElement(b.a,{style:{color:"white"},fluid:!0},r.a.createElement(w,null,de),r.a.createElement(w,null,r.a.createElement(p.a,null,r.a.createElement("h4",null,"You: ",m[c]),Ee,r.a.createElement(w,{style:{color:"green",fontWeight:"bold"}},be))),r.a.createElement(j.a,{autoClose:2e3})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(130),a(131);l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(T,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},64:function(e,t,a){e.exports=a(132)},69:function(e,t,a){},70:function(e,t,a){}},[[64,1,2]]]);
//# sourceMappingURL=main.d95590ce.chunk.js.map
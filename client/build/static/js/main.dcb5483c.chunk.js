(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{101:function(e,t){},117:function(e,t){},119:function(e,t){},152:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(11),o=n.n(c),l=(n(70),n(6)),i=n(56),u=(n(71),n(57)),s=n.n(u),m=n(28),d=n.n(m),f=n(59),g=n(163),v=n(165),b=n(164),E=n(162),p=n(64),j=n(12),k=n(157),y=n(158),O=n(159),C=n(160),h=n(161),S=n(58),T=n.n(S);function w(){var e=Object(i.a)(["\n  display: flex;\n  width: 100%;\n"]);return w=function(){return e},e}var L=new Audio("./skype_remix_2.mp3");L.loop=!0;var N=function(){return r.a.createElement(T.a,{type:"TailSpin",color:"#00BFFF"})},z=f.a.div(w());var D=function(){var e=Object(a.useRef)(null),t=Object(a.useState)(""),n=Object(l.a)(t,2),c=n[0],o=n[1],i=Object(a.useState)({}),u=Object(l.a)(i,2),m=u[0],f=u[1],S=Object(a.useState)(),T=Object(l.a)(S,2),w=T[0],D=T[1],P=Object(a.useState)(!1),x=Object(l.a)(P,2),A=x[0],M=x[1],R=Object(a.useState)(""),V=Object(l.a)(R,2),B=V[0],F=V[1],I=Object(a.useState)(),U=Object(l.a)(I,2),G=U[0],W=U[1],J=Object(a.useState)(!1),_=Object(l.a)(J,2),H=_[0],Y=_[1],$=Object(a.useState)(!1),q=Object(l.a)($,2),K=q[0],Q=q[1],X=Object(a.useState)(!1),Z=Object(l.a)(X,2),ee=Z[0],te=Z[1],ne=Object(a.useState)(!1),ae=Object(l.a)(ne,2),re=ae[0],ce=ae[1],oe=Object(a.useState)(""),le=Object(l.a)(oe,2),ie=le[0],ue=le[1],se=Object(a.useRef)(),me=Object(a.useRef)(),de=Object(a.useRef)(),fe=Object(a.useState)(!0),ge=Object(l.a)(fe,2),ve=ge[0],be=ge[1],Ee=Object(a.useState)(!0),pe=Object(l.a)(Ee,2),je=pe[0],ke=pe[1],ye=Object(a.useState)(!1),Oe=Object(l.a)(ye,2),Ce=Oe[0],he=Oe[1],Se=Object(a.useState)("user"),Te=Object(l.a)(Se,2),we=Te[0];function Le(t){ce(!0),e.current=new d.a({initiator:!0,trickle:!1,stream:w,config:{iceServers:[{urls:"stun:stun.stunprotocol.org"},{urls:"turn:numb.viagenie.ca",credential:"muazkh",username:"webrtc@live.com"}]}}),console.log("Call user"),e.current.on("signal",(function(e){de.current.emit("callerSignal",{userToCall:t,signalData:e,from:c})})),de.current.emit("callUser",{userToCall:t,from:c}),e.current.on("stream",(function(e){me.current&&(me.current.srcObject=e)})),e.current.on("connect",(function(){j.b.info("Connected")})),de.current.on("callAccepted",(function(n){Y(!0),ue(t),e.current.signal(n),ce(!0),console.log("accepted"),te(!1)})),e.current.on("error",(function(e){console.log(e),"Call ended"!==e&&alert("Connection error or client closed webpage!"),ue(""),Y(!1),ce(!1),de.current.removeListener("callAccepted"),de.current.removeListener("videoStatusChange"),de.current.removeListener("audioStatusChange")})),de.current.on("callEnded",(function(){ue(""),Y(!1),ce(!1),de.current.removeListener("callAccepted"),de.current.removeListener("videoStatusChange"),de.current.removeListener("audioStatusChange")})),de.current.on("error",(function(t){e.current.destroy(t.message)}))}function Ne(){Ve(1e3),Ce&&ze(),setTimeout((function(){var t=w.getVideoTracks()[0];"ended"===t.readyState?navigator.mediaDevices.getUserMedia({video:{facingMode:we}}).then((function(n){var a=n.getVideoTracks()[0];w.removeTrack(t),w.addTrack(a),be(!0),H&&e.current.replaceTrack(t,a,w)})):"live"===t.readyState&&(t.stop(),be(!1),H&&e.current.replaceTrack(t,t,w))}),500)}function ze(){Ve(1e3),ve&&Ne(),setTimeout((function(){var t=w.getVideoTracks()[0];"ended"===t.readyState?navigator.mediaDevices.getDisplayMedia({video:!0,audio:!0}).then((function(n){var a=n.getVideoTracks()[0];w.removeTrack(t),w.addTrack(a),he(!0),H&&e.current.replaceTrack(t,a,w),w.getVideoTracks()[0].addEventListener("ended",(function(){he(!1)}))})):"live"===t.readyState&&(t.stop(),he(!1),H&&e.current.replaceTrack(t,t,w))}),500)}Te[1],Object(a.useEffect)((function(){de.current=s.a.connect(""),navigator.mediaDevices.getUserMedia({video:{facingMode:we},audio:!0}).then((function(e){D(e),se.current&&(se.current.srcObject=e)})).catch((function(e){j.b.error("Provide Permission")})),de.current.on("yourID",(function(e){o(e)})),de.current.on("allUsers",(function(e){console.log(e),f(e)})),de.current.on("receiveSignal",(function(e){console.log("Reciving signal"),W(e.signal)})),de.current.on("receiveCall",(function(e){console.log("Reciving"),M(!0),ce(!0),F(e.from.name),ue(e.from.id)})),de.current.on("changeNameStatus",(function(e){e.status||j.b.error("name already taken!")}))}),[]),Object(a.useEffect)((function(){de.current.on("callPermissionGranted",(function(e){m[e.from]&&(console.log("Permission Granted from "+m[e.from]),te(e.from))}))}),[m]);var De,Pe,xe,Ae,Me,Re,Ve=function(e){Q(!0),setTimeout((function(){Q(!1)}),e)},Be=r.a.createElement(g.a,{onSubmit:function(e){e.preventDefault();var t=e.target.name.value,n=!1;Object.keys(m).forEach((function(e){e!==c&&t===m[e]&&(n=!0)})),n?j.b.error("name already taken!"):de.current.emit("changeName",{name:t})}},r.a.createElement(g.a.Group,{controlId:"name"},r.a.createElement(g.a.Label,null,"Change Display name"),r.a.createElement(g.a.Control,{type:"text",placeholder:"Enter name"})),r.a.createElement(v.a,{variant:"primary",type:"submit",size:"sm"},r.a.createElement("small",null,"Change Name")));w&&(De=r.a.createElement("video",{className:"userVideo",playsInline:!0,muted:!0,ref:se,autoPlay:!0}),"professor"===m[c]?Pe=Object.keys(m).map((function(e){return e===c?null:r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a,{variant:"primary",onClick:function(){return Le(e)},disabled:re,style:{margin:5}},"Call ",m[e]),r.a.createElement(v.a,{variant:"success",onClick:function(){return t=e,void de.current.emit("giveCallPermission",{from:c,to:t});var t},disabled:re,style:{margin:5}},"give Permission to ",m[e]))})):ee&&(xe=r.a.createElement(v.a,{variant:"primary",onClick:function(){return Le(ee)},disabled:re,style:{margin:5}},"Call ",m[ee]))),H&&(Ae=r.a.createElement("video",{className:"partnerVideo",playsInline:!0,ref:me,autoPlay:!0}),Me=r.a.createElement("div",{className:"endCallButton"},r.a.createElement(v.a,{variant:"danger",onClick:function(){return de.current.emit("endCall",{id:ie}),void e.current.destroy("Call ended")}},"End Call")));var Fe,Ie,Ue=ve?"success":"danger",Ge=je?"success":"danger",We=Ce?"success":"danger",Je=ve?r.a.createElement(k.a,{size:20}):r.a.createElement(y.a,{size:20}),_e=je?r.a.createElement(O.a,{size:20}):r.a.createElement(C.a,{size:20}),He=r.a.createElement(h.a,{size:20}),Ye=!H;return Re=r.a.createElement(z,{className:"justify-content-md-center"},r.a.createElement(v.a,{variant:Ue,onClick:Ne,style:{margin:5},disabled:Ye}," ",Je," "),r.a.createElement(v.a,{variant:Ge,onClick:function(){Ve(400);var t=w.getAudioTracks()[0];"ended"===t.readyState?navigator.mediaDevices.getUserMedia({audio:!0}).then((function(n){var a=n.getAudioTracks()[0];w.removeTrack(t),w.addTrack(a),ke(!0),H&&e.current.replaceTrack(t,a,w)})):"live"===t.readyState&&(t.stop(),ke(!1),H&&e.current.replaceTrack(t,t,w))},style:{margin:5},disabled:Ye}," ",_e," "),r.a.createElement(v.a,{variant:We,onClick:ze,style:{margin:5},disabled:Ye}," ",He," ")),"professor"!==m[c]&&Object.keys(m).forEach((function(e){e!==c&&"professor"===m[e]&&(Fe="Professor online")})),A&&m[ie]&&G?(L.play(),Ie=r.a.createElement("div",{className:"incommingCall"},r.a.createElement(b.a,{className:"text-center",style:{background:"black",color:"white"}},r.a.createElement(b.a.Header,null,r.a.createElement("h2",null,B," is calling you")),r.a.createElement(b.a.Body,null,r.a.createElement(b.a.Title,null),r.a.createElement(E.a,null,r.a.createElement(z,null,r.a.createElement(p.a,null,r.a.createElement(v.a,{size:"lg",variant:"danger",onClick:function(){}},"Reject")),r.a.createElement(p.a,null,r.a.createElement(v.a,{size:"lg",variant:"success",onClick:function(){L.pause(),L.currentTime=0,Y(!0),M(!1),ce(!0),e.current=new d.a({initiator:!1,trickle:!1,stream:w,config:{iceServers:[{urls:"stun:stun.stunprotocol.org"},{urls:"turn:numb.viagenie.ca",credential:"muazkh",username:"webrtc@live.com"}]}}),e.current.on("signal",(function(e){console.log("call accept signal"),de.current.emit("acceptCall",{signal:e,to:ie})})),e.current.on("stream",(function(e){me.current.srcObject=e})),e.current.signal(G),e.current.on("connect",(function(){j.b.info("Connected")})),e.current.on("error",(function(e){console.log(e),Y(!1),F(""),ue(""),W(),ce(!1),de.current.removeListener("videoStatusChange"),de.current.removeListener("audioStatusChange"),"Call ended"!==e&&alert("Connection error or client closed webpage!")})),de.current.on("callEnded",(function(){Y(!1),F(""),ue(""),W(),ce(!1),de.current.removeListener("videoStatusChange"),de.current.removeListener("audioStatusChange")}))}},"Accept"))))),r.a.createElement(b.a.Footer,{className:"text-muted"})))):(L.pause(),L.currentTime=0),r.a.createElement(r.a.Fragment,null,Ie,Ae,r.a.createElement("div",{className:"userElements"},De,Re),r.a.createElement("div",{className:"userElementsLoadingBox",hidden:!K},r.a.createElement("div",{className:"userElementsLoading"},r.a.createElement(N,null))),Me,r.a.createElement(E.a,{style:{color:"white"},fluid:!0},r.a.createElement(z,null,Pe," ",xe),r.a.createElement(z,null,r.a.createElement(p.a,null,r.a.createElement("h4",null,"You: ",m[c]),Be,r.a.createElement(z,{style:{color:"green",fontWeight:"bold"}},Fe))),r.a.createElement(j.a,{autoClose:2e3})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(150),n(151);o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(D,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},65:function(e,t,n){e.exports=n(152)},70:function(e,t,n){},71:function(e,t,n){}},[[65,1,2]]]);
//# sourceMappingURL=main.dcb5483c.chunk.js.map
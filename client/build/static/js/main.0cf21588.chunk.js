(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{113:function(e,t){},115:function(e,t){},147:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(10),o=n.n(c),i=(n(68),n(6)),l=n(54),u=(n(69),n(55)),s=n.n(u),m=n(27),d=n.n(m),f=n(57),v=n(158),g=n(160),b=n(159),E=n(157),p=n(61),j=n(12),O=n(152),k=n(153),y=n(154),C=n(155),h=n(156),S=n(56),T=n.n(S);function w(){var e=Object(l.a)(["\n  display: flex;\n  width: 100%;\n"]);return w=function(){return e},e}var L=new Audio("./skype_remix_2.mp3");L.loop=!0;var N=function(){return r.a.createElement(T.a,{type:"TailSpin",color:"#00BFFF"})},D=f.a.div(w());var P=function(){var e=Object(a.useRef)(null),t=Object(a.useState)(""),n=Object(i.a)(t,2),c=n[0],o=n[1],l=Object(a.useState)({}),u=Object(i.a)(l,2),m=u[0],f=u[1],S=Object(a.useState)(),T=Object(i.a)(S,2),w=T[0],P=T[1],z=Object(a.useState)(!1),x=Object(i.a)(z,2),A=x[0],M=x[1],R=Object(a.useState)(""),V=Object(i.a)(R,2),B=V[0],F=V[1],I=Object(a.useState)(),U=Object(i.a)(I,2),G=U[0],J=U[1],W=Object(a.useState)(!1),_=Object(i.a)(W,2),H=_[0],Y=_[1],$=Object(a.useState)(!1),q=Object(i.a)($,2),K=q[0],Q=q[1],X=Object(a.useState)(!1),Z=Object(i.a)(X,2),ee=Z[0],te=Z[1],ne=Object(a.useState)(!1),ae=Object(i.a)(ne,2),re=ae[0],ce=ae[1],oe=Object(a.useState)(""),ie=Object(i.a)(oe,2),le=ie[0],ue=ie[1],se=Object(a.useRef)(),me=Object(a.useRef)(),de=Object(a.useRef)(),fe=Object(a.useState)(!0),ve=Object(i.a)(fe,2),ge=ve[0],be=ve[1],Ee=Object(a.useState)(!0),pe=Object(i.a)(Ee,2),je=pe[0],Oe=pe[1],ke=Object(a.useState)(!1),ye=Object(i.a)(ke,2),Ce=ye[0],he=ye[1],Se=Object(a.useState)("user"),Te=Object(i.a)(Se,2),we=Te[0];function Le(){Re(1e3),Ce&&Ne(),setTimeout((function(){var t=w.getVideoTracks()[0];"ended"===t.readyState?navigator.mediaDevices.getUserMedia({video:{facingMode:we}}).then((function(n){var a=n.getVideoTracks()[0];w.removeTrack(t),w.addTrack(a),be(!0),H&&e.current.replaceTrack(t,a,w)})):"live"===t.readyState&&(t.stop(),be(!1),H&&e.current.replaceTrack(t,t,w))}),500)}function Ne(){Re(1e3),ge&&Le(),setTimeout((function(){var t=w.getVideoTracks()[0];"ended"===t.readyState?navigator.mediaDevices.getDisplayMedia({video:!0,audio:!0}).then((function(n){var a=n.getVideoTracks()[0];w.removeTrack(t),w.addTrack(a),he(!0),H&&e.current.replaceTrack(t,a,w),w.getVideoTracks()[0].addEventListener("ended",(function(){he(!1)}))})):"live"===t.readyState&&(t.stop(),he(!1),H&&e.current.replaceTrack(t,t,w))}),500)}Te[1],Object(a.useEffect)((function(){de.current=s.a.connect(""),navigator.mediaDevices.getUserMedia({video:{facingMode:we},audio:!0}).then((function(e){P(e),se.current&&(se.current.srcObject=e)})).catch((function(e){j.b.error("Provide Permission")})),de.current.on("yourID",(function(e){o(e)})),de.current.on("allUsers",(function(e){console.log(e),f(e)})),de.current.on("receiveSignal",(function(e){console.log("Reciving signal"),J(e.signal)})),de.current.on("receiveCall",(function(e){console.log("Reciving"),M(!0),ce(!0),F(e.from.name),ue(e.from.id)})),de.current.on("changeNameStatus",(function(e){e.status||j.b.error("name already taken!")}))}),[]),Object(a.useEffect)((function(){de.current.on("callPermissionGranted",(function(e){m[e.from]&&(console.log("Permission Granted from "+m[e.from]),te(e.from))}))}),[m]);var De,Pe,ze,xe,Ae,Me,Re=function(e){Q(!0),setTimeout((function(){Q(!1)}),e)},Ve=r.a.createElement(v.a,{onSubmit:function(e){e.preventDefault();var t=e.target.name.value,n=!1;Object.keys(m).forEach((function(e){e!==c&&t===m[e]&&(n=!0)})),n?j.b.error("name already taken!"):de.current.emit("changeName",{name:t})}},r.a.createElement(v.a.Group,{controlId:"name"},r.a.createElement(v.a.Label,null,"Change Display name"),r.a.createElement(v.a.Control,{type:"text",placeholder:"Enter name"})),r.a.createElement(g.a,{variant:"primary",type:"submit",size:"sm"},r.a.createElement("small",null,"Change Name")));w&&(De=r.a.createElement("video",{className:"userVideo",playsInline:!0,muted:!0,ref:se,autoPlay:!0}),Pe=Object.keys(m).map((function(e){return e===c?null:r.a.createElement(r.a.Fragment,null,r.a.createElement(g.a,{variant:"success",onClick:function(){return t=e,void de.current.emit("giveCallPermission",{from:c,to:t});var t},disabled:re,style:{margin:5}},"give Permission to ",m[e]))})),ee&&(ze=r.a.createElement(g.a,{variant:"primary",onClick:function(){return t=ee,ce(!0),e.current=new d.a({initiator:!0,trickle:!1,stream:w,reconnectTimer:!0}),console.log("Call user"),e.current.on("signal",(function(e){de.current.emit("callerSignal",{userToCall:t,signalData:e,from:c})})),de.current.emit("callUser",{userToCall:t,from:c}),e.current.on("stream",(function(e){me.current&&(me.current.srcObject=e)})),e.current.on("connect",(function(){j.b.info("Connected")})),de.current.on("callAccepted",(function(n){Y(!0),ue(t),e.current.signal(n),ce(!0),console.log("accepted"),te(!1)})),e.current.on("error",(function(e){console.log(e),"Call ended"!==e&&alert("Connection error or client closed webpage!"),ue(""),Y(!1),ce(!1),de.current.removeListener("callAccepted"),de.current.removeListener("videoStatusChange"),de.current.removeListener("audioStatusChange")})),de.current.on("callEnded",(function(){ue(""),Y(!1),ce(!1),de.current.removeListener("callAccepted"),de.current.removeListener("videoStatusChange"),de.current.removeListener("audioStatusChange")})),void de.current.on("error",(function(t){e.current.destroy(t.message)}));var t},disabled:re,style:{margin:5}},"Call ",m[ee]))),H&&(xe=r.a.createElement("video",{className:"partnerVideo",playsInline:!0,ref:me,autoPlay:!0}),Ae=r.a.createElement("div",{className:"endCallButton"},r.a.createElement(g.a,{variant:"danger",onClick:function(){return de.current.emit("endCall",{id:le}),void e.current.destroy("Call ended")}},"End Call")));var Be,Fe=ge?"success":"danger",Ie=je?"success":"danger",Ue=Ce?"success":"danger",Ge=ge?r.a.createElement(O.a,{size:20}):r.a.createElement(k.a,{size:20}),Je=je?r.a.createElement(y.a,{size:20}):r.a.createElement(C.a,{size:20}),We=r.a.createElement(h.a,{size:20}),_e=!H;return Me=r.a.createElement(D,{className:"justify-content-md-center"},r.a.createElement(g.a,{variant:Fe,onClick:Le,style:{margin:5},disabled:_e}," ",Ge," "),r.a.createElement(g.a,{variant:Ie,onClick:function(){Re(400);var t=w.getAudioTracks()[0];"ended"===t.readyState?navigator.mediaDevices.getUserMedia({audio:!0}).then((function(n){var a=n.getAudioTracks()[0];w.removeTrack(t),w.addTrack(a),Oe(!0),H&&e.current.replaceTrack(t,a,w)})):"live"===t.readyState&&(t.stop(),Oe(!1),H&&e.current.replaceTrack(t,t,w))},style:{margin:5},disabled:_e}," ",Je," "),r.a.createElement(g.a,{variant:Ue,onClick:Ne,style:{margin:5},disabled:_e}," ",We," ")),"professor"!==m[c]&&Object.keys(m).forEach((function(e){e!==c&&"professor"===m[e]&&"Professor online"})),A&&m[le]&&G?(L.play(),Be=r.a.createElement("div",{className:"incommingCall"},r.a.createElement(b.a,{className:"text-center",style:{background:"black",color:"white"}},r.a.createElement(b.a.Header,null,r.a.createElement("h2",null,B," is calling you")),r.a.createElement(b.a.Body,null,r.a.createElement(b.a.Title,null),r.a.createElement(E.a,null,r.a.createElement(D,null,r.a.createElement(p.a,null,r.a.createElement(g.a,{size:"lg",variant:"danger",onClick:function(){}},"Reject")),r.a.createElement(p.a,null,r.a.createElement(g.a,{size:"lg",variant:"success",onClick:function(){L.pause(),L.currentTime=0,Y(!0),M(!1),ce(!0),e.current=new d.a({initiator:!1,trickle:!1,stream:w,reconnectTimer:!0}),e.current.on("signal",(function(e){de.current.emit("acceptCall",{signal:e,to:le})})),e.current.on("stream",(function(e){me.current.srcObject=e})),e.current.signal(G),e.current.on("connect",(function(){j.b.info("Connected")})),e.current.on("error",(function(e){console.log(e),"Call ended"!==e&&alert("Connection error or client closed webpage!"),Y(!1),F(""),ue(""),J(),ce(!1),de.current.removeListener("videoStatusChange"),de.current.removeListener("audioStatusChange")})),de.current.on("callEnded",(function(){Y(!1),F(""),ue(""),J(),ce(!1),de.current.removeListener("videoStatusChange"),de.current.removeListener("audioStatusChange")}))}},"Accept"))))),r.a.createElement(b.a.Footer,{className:"text-muted"})))):(L.pause(),L.currentTime=0),r.a.createElement(r.a.Fragment,null,Be,xe,r.a.createElement("div",{className:"userElements"},De,Me),r.a.createElement("div",{className:"userElementsLoadingBox",hidden:!K},r.a.createElement("div",{className:"userElementsLoading"},r.a.createElement(N,null))),Ae,r.a.createElement(E.a,{style:{color:"white"},fluid:!0},r.a.createElement(D,null,Pe," ",ze),r.a.createElement(D,null,r.a.createElement(p.a,null,r.a.createElement("h4",null,"You: ",m[c]),Ve)),r.a.createElement(j.a,{autoClose:2e3})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(145),n(146);o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(P,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},63:function(e,t,n){e.exports=n(147)},68:function(e,t,n){},69:function(e,t,n){},98:function(e,t){}},[[63,1,2]]]);
//# sourceMappingURL=main.0cf21588.chunk.js.map
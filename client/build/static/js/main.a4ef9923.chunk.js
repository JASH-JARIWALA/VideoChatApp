(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{115:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(9),o=n.n(c),i=(n(55),n(6)),l=n(41),u=(n(56),n(42)),s=n.n(u),m=n(44),d=n(126),f=n(128),b=n(127),g=n(125),E=n(49),v=n(11),p=n(120),O=n(121),j=n(122),h=n(123),y=n(124),C=n(43),k=n.n(C);function S(){var e=Object(l.a)(["\n  display: flex;\n  width: 100%;\n"]);return S=function(){return e},e}var w=new Audio("./skype_remix_2.mp3");w.loop=!0;var T=function(){return r.a.createElement(k.a,{type:"TailSpin",color:"#00BFFF"})},D=m.a.div(S());var R=function(){var e=Object(a.useRef)(null),t=Object(a.useState)(""),n=Object(i.a)(t,2),c=n[0],o=n[1],l=Object(a.useState)({}),u=Object(i.a)(l,2),m=u[0],C=u[1],k=Object(a.useState)(),S=Object(i.a)(k,2),R=S[0],N=S[1],P=Object(a.useState)(!1),x=Object(i.a)(P,2),I=x[0],F=x[1],L=Object(a.useState)(""),z=Object(i.a)(L,2),B=z[0],A=z[1],G=Object(a.useState)(),M=Object(i.a)(G,2),U=M[0],W=M[1],J=Object(a.useState)(!1),V=Object(i.a)(J,2),_=V[0],H=V[1],Y=Object(a.useState)(!1),$=Object(i.a)(Y,2),q=$[0],K=($[1],Object(a.useState)(!1)),Q=Object(i.a)(K,2),X=Q[0],Z=Q[1],ee=Object(a.useState)(!1),te=Object(i.a)(ee,2),ne=te[0],ae=te[1],re=Object(a.useState)(""),ce=Object(i.a)(re,2),oe=ce[0],ie=ce[1],le=Object(a.useRef)(),ue=Object(a.useRef)(),se=Object(a.useRef)(),me=Object(a.useState)(!0),de=Object(i.a)(me,2),fe=de[0],be=(de[1],Object(a.useState)(!0)),ge=Object(i.a)(be,2),Ee=ge[0],ve=(ge[1],Object(a.useState)(!1)),pe=Object(i.a)(ve,2),Oe=(pe[0],pe[1],Object(a.useState)("user")),je=Object(i.a)(Oe,2),he=je[0];function ye(t){var n=new RTCIceCandidate(t);console.log("## ----- "+e.current),e.current.addIceCandidate(n).catch((function(e){return console.log(e)}))}function Ce(t){ae(!0),e.current=new RTCPeerConnection({iceServers:[{urls:"stun:stun.stunprotocol.org"},{urls:"turn:numb.viagenie.ca",credential:"muazkh",username:"webrtc@live.com"}]}),console.log(e.current),se.current.on("ice-candidate",ye),e.current.onicecandidate=function(e){e.candidate&&se.current.emit("ice-candidate",{to:t,candidate:e.candidate})},e.current.ontrack=function(e){ue.current.srcObject=e.streams[0]},e.current.onnegotiationneeded=function(){e.current.createOffer().then((function(t){return e.current.setLocalDescription(t)})).then((function(){se.current.emit("callerSignal",{userToCall:t,signalData:e.current.localDescription,from:c})})).catch((function(e){return console.log(e)}))},se.current.emit("callUser",{userToCall:t,from:c}),R.getTracks().forEach((function(t){return e.current.addTrack(t,R)})),se.current.on("callAccepted",(function(n){H(!0),ie(t);var a=new RTCSessionDescription(n);e.current.setRemoteDescription(a).catch((function(e){return console.log(e)})),ae(!0),console.log("accepted"),Z(!1)}))}je[1],Object(a.useEffect)((function(){se.current=s.a.connect(""),navigator.mediaDevices.getUserMedia({video:{facingMode:he},audio:!0}).then((function(e){N(e),le.current&&(le.current.srcObject=e)})).catch((function(e){v.b.error("Provide Permission")})),se.current.on("yourID",(function(e){o(e)})),se.current.on("allUsers",(function(e){console.log(e),C(e)})),se.current.on("receiveSignal",(function(e){console.log("Reciving signal"),W(e.signal)})),se.current.on("receiveCall",(function(e){console.log("Reciving"),F(!0),ae(!0),A(e.from.name),ie(e.from.id)})),se.current.on("changeNameStatus",(function(e){e.status||v.b.error("name already taken!")}))}),[]),Object(a.useEffect)((function(){se.current.on("callPermissionGranted",(function(e){m[e.from]&&(console.log("Permission Granted from "+m[e.from]),Z(e.from))}))}),[m]);var ke,Se,we,Te,De,Re,Ne=r.a.createElement(d.a,{onSubmit:function(e){e.preventDefault();var t=e.target.name.value,n=!1;Object.keys(m).forEach((function(e){e!==c&&t===m[e]&&(n=!0)})),n?v.b.error("name already taken!"):se.current.emit("changeName",{name:t})}},r.a.createElement(d.a.Group,{controlId:"name"},r.a.createElement(d.a.Label,null,"Change Display name"),r.a.createElement(d.a.Control,{type:"text",placeholder:"Enter name"})),r.a.createElement(f.a,{variant:"primary",type:"submit",size:"sm"},r.a.createElement("small",null,"Change Name")));return R&&(ke=r.a.createElement("video",{className:"userVideo",playsInline:!0,muted:!0,ref:le,autoPlay:!0}),"professor"===m[c]?Se=Object.keys(m).map((function(e){return e===c?null:r.a.createElement(r.a.Fragment,null,r.a.createElement(f.a,{variant:"primary",onClick:function(){return Ce(e)},disabled:ne,style:{margin:5}},"Call ",m[e]),r.a.createElement(f.a,{variant:"success",onClick:function(){return t=e,void se.current.emit("giveCallPermission",{from:c,to:t});var t},disabled:ne,style:{margin:5}},"give Permission to ",m[e]))})):X&&(we=r.a.createElement(f.a,{variant:"primary",onClick:function(){return Ce(X)},disabled:ne,style:{margin:5}},"Call ",m[X]))),_&&(Te=r.a.createElement("video",{className:"partnerVideo",playsInline:!0,ref:ue,autoPlay:!0})),fe?p.a:O.a,Ee?j.a:h.a,y.a,"professor"!==m[c]&&Object.keys(m).forEach((function(e){e!==c&&"professor"===m[e]&&(De="Professor online")})),I&&m[oe]&&U?(w.play(),Re=r.a.createElement("div",{className:"incommingCall"},r.a.createElement(b.a,{className:"text-center",style:{background:"black",color:"white"}},r.a.createElement(b.a.Header,null,r.a.createElement("h2",null,B," is calling you")),r.a.createElement(b.a.Body,null,r.a.createElement(b.a.Title,null),r.a.createElement(g.a,null,r.a.createElement(D,null,r.a.createElement(E.a,null,r.a.createElement(f.a,{size:"lg",variant:"danger",onClick:function(){}},"Reject")),r.a.createElement(E.a,null,r.a.createElement(f.a,{size:"lg",variant:"success",onClick:function(){w.pause(),w.currentTime=0,H(!0),F(!1),ae(!0),e.current=new RTCPeerConnection({iceServers:[{urls:"stun:stun.stunprotocol.org"},{urls:"turn:numb.viagenie.ca",credential:"muazkh",username:"webrtc@live.com"}]}),se.current.on("ice-candidate",ye),e.current.onicecandidate=function(e){e.candidate&&se.current.emit("ice-candidate",{to:oe,candidate:e.candidate})},e.current.ontrack=function(e){ue.current.srcObject=e.streams[0]},e.current.onnegotiationneeded=function(){e.current.createOffer().then((function(t){return e.current.setLocalDescription(t)})).then((function(){})).catch((function(e){return console.log(e)}))};var t=new RTCSessionDescription(U);e.current.setRemoteDescription(t).then((function(){R.getTracks().forEach((function(t){return e.current.addTrack(t,R)}))})).then((function(){return e.current.createAnswer()})).then((function(t){return e.current.setLocalDescription(t)})).then((function(){se.current.emit("acceptCall",{signal:e.current.localDescription,to:oe})}))}},"Accept"))))),r.a.createElement(b.a.Footer,{className:"text-muted"})))):(w.pause(),w.currentTime=0),r.a.createElement(r.a.Fragment,null,Re,Te,r.a.createElement("div",{className:"userElements"},ke,void 0),r.a.createElement("div",{className:"userElementsLoadingBox",hidden:!q},r.a.createElement("div",{className:"userElementsLoading"},r.a.createElement(T,null))),void 0,r.a.createElement(g.a,{style:{color:"white"},fluid:!0},r.a.createElement(D,null,Se," ",we),r.a.createElement(D,null,r.a.createElement(E.a,null,r.a.createElement("h4",null,"You: ",m[c]),Ne,r.a.createElement(D,{style:{color:"green",fontWeight:"bold"}},De))),r.a.createElement(v.a,{autoClose:2e3})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(113),n(114);o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(R,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},50:function(e,t,n){e.exports=n(115)},55:function(e,t,n){},56:function(e,t,n){},87:function(e,t){}},[[50,1,2]]]);
//# sourceMappingURL=main.a4ef9923.chunk.js.map